
<div class="row p-3" id="machine-title">
    <h1 class="display-6 text-uppercase fw-semibold m-0"><i class="bi bi-clock-history"></i> Tareas</h1>
</div>
<div class="row p-4">
    <div class="row justify-content-between p-0 m-0" id="machine-add-title">
        <div class="col-md-8 p-2">
            <p class="fs-5 m-0">Historial de cotizaciones realizadas.</p>
        </div>
    </div>
</div>
<div class="row px-4 pt-0 pb-4">
    <div class="table-responsive-xxl p-0">
        <table class="table table-striped align-middle" id="hist-table">
            <thead>
                <tr>
                    <th scope="col">No. Orden</th>
                    <th scope="col">No. Cotizaci√≥n</th>
                    <th scope="col">Fecha y hora</th>
                    <th scope="col">Cliente</th>
                    <th scope="col">Proyecto</th>
                    <th scope="col">Monto total</th>
                    <th scope="col">Estatus</th>
                </tr>
            </thead>
            <tbody class="table-group-divider">
                {{#each cotizaciones}}
                    <tr>
                        <th scope="row">
                            {{#checkPermission ../user.permisos "seeListOrders"}}
                                <a class="icon-link icon-link-hover link-underline link-underline-opacity-0" style="--bs-icon-link-transform: translate3d(0, -.15rem, 0); --bs-link-hover-color-rgb: 237, 10, 63;" href="/orders/info/{{ordenId}}">
                                    <i class="bi bi-box-arrow-in-up-right mb-auto"></i>
                                    OT-{{ordenId}}
                                </a>
                            {{else}}
                                <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="Acceso denegado">
                                    <a class="icon-link link-underline link-underline-opacity-0 pe-none" style="--bs-link-opacity: .80;">
                                        <i class="bi bi-box-arrow-in-up-right mb-auto"></i>
                                        OT-{{ordenId}}
                                    </a>
                                </span>
                            {{/checkPermission}}
                        </th>
                        <th scope="row">
                            {{#checkPermission ../user.permisos "seeListQuotations"}}
                                <a class="icon-link icon-link-hover link-underline link-underline-opacity-0" style="--bs-icon-link-transform: translate3d(0, -.15rem, 0); --bs-link-hover-color-rgb: 237, 10, 63;" href="/quotations/info/{{cotId}}">
                                    <i class="bi bi-box-arrow-in-up-right mb-auto"></i>
                                    COT-{{cotId}}
                                </a>
                            {{else}}
                                <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="Acceso denegado">
                                    <a class="icon-link link-underline link-underline-opacity-0 pe-none" style="--bs-link-opacity: .80;">
                                        <i class="bi bi-box-arrow-in-up-right mb-auto"></i>
                                        COT-{{cotId}}
                                    </a>
                                </span>
                            {{/checkPermission}}
                        </th>
                        <td>{{formatDateShort fecha}}</td>
                        <td>
                            {{#checkPermission ../user.permisos "seeListClients"}}
                                <a class="icon-link icon-link-hover link-underline link-underline-opacity-0" style="--bs-icon-link-transform: translate3d(0, -.15rem, 0); --bs-link-hover-color-rgb: 237, 10, 63;" href="/clients/infoClient/{{clienteId}}">
                                    <i class="bi bi-box-arrow-in-up-right mb-auto"></i>
                                    {{nombre}}
                                </a>
                            {{else}}
                                <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="Acceso denegado">
                                    <a class="icon-link link-underline link-underline-opacity-0 pe-none" style="--bs-link-opacity: .80;">
                                        <i class="bi bi-box-arrow-in-up-right mb-auto"></i>
                                        {{nombre}}
                                    </a>
                                </span>
                            {{/checkPermission}}
                        </td>
                        <td>{{proyecto}}</td>
                        <td>$ {{formatNumber total}}</td>
                        {{#equal estatus "Ordenada"}}
                            <td class="text-success">{{estatus}}</td>
                        {{/equal}}
                    </tr>
                {{else}}
                    <tr>
                        <td class="d-none"></td>
                        <td class="d-none"></td>
                        <td class="d-none"></td>
                        <td class="d-none"></td>
                        <td class="d-none"></td>
                        <td class="d-none"></td>
                        <td colspan="7">No existen cotizaciones registradas</td>
                    </tr>
                {{/each}}
            </tbody>
        </table>
    </div>
</div>

<script>
    $.fn.dataTable.moment('DD/MM/YYYY, HH:mm');
    new DataTable('#hist-table', {
        paging: false,
        info: false,
        padding: false,
        order: [[2, 'Desc']],
        dom: '<"float-start pb-2"f>', 
        language:{
            url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/es-MX.json',
        },
    });
</script>
